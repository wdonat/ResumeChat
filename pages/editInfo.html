<!DOCTYPE html>
<html>
<head>

<meta name="Author" content="Wolfram Donat" />
<meta name="copyright" content="2024 Wolfram Donat" />
<meta name="date" content="2024-02-01" />
<meta name="Description" lang="us" content="" />
<meta name="Keywords" content="" />
<meta name="Robots" content="Index, All" />
<meta charset="UTF-8">

<link rel="shortcut icon" type="image/png" href="static/images/favicon.ico" />

<link rel="stylesheet" type="text/css" href="static/styles/styles.css" />

<script src="static/scripts/server-communication.js"></script>

<script>

    // document.addEventListener('contextmenu', event => event.preventDefault());
    function logout()
    {
        postToServer("logout", { }, processLogoutResponse);
    }

    function processLogoutResponse(response)
    {
        window.location.href = "index.html";
        alert("You have been logged out.");
    }

    function faq()
    {
        window.location.href = "faq.html";
    }

    function account()
    {
        var url_string = window.location.href;
        var url = new URL(url_string);
        var userID = url.searchParams.get("id");
        window.location.href = "account.html?id=" + userID;
    }

    var userLinkID;

    document.addEventListener('submit', function(e)
        {e.preventDefault();
        var myResume = document.getElementById("resumeUpload");
        var formData = new FormData(myResume);

        fetch('http://localhost:8000/api/v1/commandHandler',
        {
            method: 'POST',
            enctype: 'multipart/form-data',
            credentials: 'include',
            body: formData
        })
            .then(response => response.json())
            .then(response => { processSubmitFormDataResponse(response)
        });
    });

    function processSubmitFormDataResponse(response)
    {
        console.log(response);
        if(response.responseCode == 1)
        {
            alert(response.responseMessage);
            alert("Please scroll to the bottom of the page, changing any necessary information on the way, and click 'Submit' to submit all changes.");
        }
        else
        {
            alert(response.responseMessage);
        }

        var myResume = document.getElementById("resumeUpload");
        myResume.reset();
        return true;
    }

    function getUserInfo(userID)
    {
        let command = "getUserInfo";
        postToServer(command, userID, processGetUserInfoResponse);
        return true;
    }

    function processGetUserInfoResponse(response)
    {
        if(response.responseCode == 0)
            alert('User Not Found');
        else
        {
            updateUserInfoDisplay(response.data);
        }   
    }

    function updateUserInfoDisplay(user)
    {
        // Link ID
        var linkID = user.link_id;
        var linkIDContent = '<font style="color: blue">' + linkID + '</font>';
        userLinkID = linkID;
        document.getElementById("linkID").innerHTML = linkIDContent;

        // Resume name
        console.log(user);
        var userID  = user.id;
        userIDContent = '<input type="file" id="resume" name="' + userID + '"><br><br><br>'
        document.getElementById("resumeName").innerHTML = userIDContent;

        // Text areas
        document.getElementById("fullName").value = user.name;
        document.getElementById("emailAddress").value = user.email;
        document.getElementById("phoneNumber").value = user.phone;
        document.getElementById("salaryRequirement").value = user.salary;
        document.getElementById("currentProjects").value = user.curr_projects;
        document.getElementById("pastProjects").value = user.past_projects;
        document.getElementById("jobSkills").value = user.skills;
        document.getElementById("jobRoles").value = user.roles;

        // Radio buttons
        if(user.on_site == 1)
        {
            document.getElementsByName("onsiteInterest")[0].checked = true;
            document.getElementsByName("onsiteInterest")[1].checked = false;
        }
        else
        {
            document.getElementsByName("onsiteInterest")[0].checked = false;
            document.getElementsByName("onsiteInterest")[1].checked = true;
        }

        if(user.hybrid == 1)
        {
            document.getElementsByName("hybridInterest")[0].checked = true;
            document.getElementsByName("hybridInterest")[1].checked = false;
        }
        else
        {
            document.getElementsByName("hybridInterest")[0].checked = false;
            document.getElementsByName("hybridInterest")[1].checked = true;
        }

        if(user.remote == 1)
        {
            document.getElementsByName("remoteInterest")[0].checked = true;
            document.getElementsByName("remoteInterest")[1].checked = false;
        }
        else
        {
            document.getElementsByName("remoteInterest")[0].checked = false;
            document.getElementsByName("remoteInterest")[1].checked = true;
        }

        if(user.travel == 1)
        {
            document.getElementsByName("travelWork")[0].checked = true;
            document.getElementsByName("travelWork")[1].checked = false;
        }
        else
        {
            document.getElementsByName("travelWork")[0].checked = false;
            document.getElementsByName("travelWork")[1].checked = true;
        }

        if(user.relocate == 1)
        {
            document.getElementsByName("relocateWork")[0].checked = true;
            document.getElementsByName("relocateWork")[1].checked = false;
        }
        else
        {
            document.getElementsByName("relocateWork")[0].checked = false;
            document.getElementsByName("relocateWork")[1].checked = true;
        }

        if(user.job_search_status == 'active')
        {
            document.getElementsByName("searchStatus")[0].checked = true;
            document.getElementsByName("searchStatus")[1].checked = false;
            document.getElementsByName("searchStatus")[2].checked = false;
        }
        else if(user.job_search_status == 'interested')
        {
            document.getElementsByName("searchStatus")[0].checked = false;
            document.getElementsByName("searchStatus")[1].checked = true;
            document.getElementsByName("searchStatus")[2].checked = false;
        }
        else
        {
            document.getElementsByName("searchStatus")[0].checked = false;
            document.getElementsByName("searchStatus")[1].checked = false;
            document.getElementsByName("searchStatus")[2].checked = true;
        }

        if(user.notice_time == "immediately")
        {
            document.getElementsByName("startTime")[0].checked = true;
            document.getElementsByName("startTime")[1].checked = false;
        }
        else
        {
            document.getElementsByName("startTime")[0].checked = false;
            document.getElementsByName("startTime")[1].checked = true;
        }

        // Checkboxes
        if(user.full_time == 1)
            document.getElementById("fulltimeWork").checked = true;
        if(user.part_time == 1)
            document.getElementById("parttimeWork").checked = true;
        if(user.contract == 1)
            document.getElementById("contractWork").checked = true;

    }

    function submitInfo()
    {
        var url_string = window.location.href;
        var url = new URL(url_string);
        var g_userID = url.searchParams.get("id");

        var fullName = document.getElementById("fullName").value;
        var emailAddress = document.getElementById("emailAddress").value;
        var phoneNumber = document.getElementById("phoneNumber").value;
        var salaryReq = document.getElementById("salaryRequirement").value;      

        var onsite = document.getElementsByName("onsiteInterest");
        var onsiteint;
        if(onsite[0].checked == true)
            onsiteint = true;
        else
            onsiteint = false;

        var hybrid = document.getElementsByName("hybridInterest");
        var hybridint;
        if(hybrid[0].checked == true)
            hybridint = true;
        else
            hybridint = false;

        var remote = document.getElementsByName("remoteInterest");
        var remoteint;
        if(remote[0].checked == true)
            remoteint = true;
        else
            remoteint = false;

        var fulltime = document.getElementById("fulltimeWork").checked;
        var parttime = document.getElementById("parttimeWork").checked;
        var contract = document.getElementById("contractWork").checked;

        var travel = document.getElementsByName("travelWork");
        var travelint;
        if(travel[0].checked == true)
            travelint = true;
        else
            travelint = false;

        var relocate = document.getElementsByName("relocateWork");
        var reloint;
        if(relocate[0].checked == true)
            reloint = true;
        else
            reloint = false;

        var search = document.getElementsByName("searchStatus");
        var searchstat;
        if(search[0].checked == true)
            searchstat = "active";
        else if(search[1].checked == true)
            searchstat = "interested";
        else
            searchstat = "browsing";

        var start = document.getElementsByName("startTime");
        var startstat;
        if(start[0].checked == true)
            startstat = "2weeks";
        else
            startstat = "immediately";

        var currentProjects = document.getElementById("currentProjects").value;
        var pastProjects = document.getElementById("pastProjects").value;
        var skills = document.getElementById("jobSkills").value;
        var roles = document.getElementById("jobRoles").value;

        data = 
        {
            "userID": g_userID,
            "fullName": fullName,
            "emailAddress": emailAddress,
            "phoneNumber": phoneNumber,
            "salaryRequirement": salaryReq,
            "onsite": onsiteint,
            "hybrid": hybridint,
            "remote": remoteint,
            "fulltime": fulltime,
            "parttime": parttime,
            "contract": contract,
            "travel": travelint,
            "relocate": reloint,
            "search": searchstat,
            "start": startstat,
            "currentProjects": currentProjects,
            "pastProjects": pastProjects,
            "skills": skills,
            "roles": roles
        };

        postToServer("submitInfo", data, processSubmitInfoResponse);
    }

    function processSubmitInfoResponse(response)
    {
        console.log(response);
        if(response.responseCode == 1)
        {
            var url_string = window.location.href;
            var url = new URL(url_string);
            var userID = url.searchParams.get("id");
            getUserInfo(userID);
            alert("All information saved!");
        }
    }

    function copyText()
    {
        navigator.clipboard.writeText(userLinkID);

        alert("Copied link to clipboard");
    }


</script>

</head>
<body>
<div id="divMainContainer" class="container homeBackground relativeContainer"> 
    <a href="index.html">
      <div class="homeLogo">
        <img src="static/images/index_logo_title.png">
      </div>
    </a>

    <center>
        <div class="generalInfoTitle">EDIT YOUR INFO</div>
        <br><br>
    </center>

    <center>
        <center>
            <h1>Your Link ID:</h1>
        </center>
        <br>
        <div class="chatLinkID" id="linkID"><font style="color: blue"> </font></div>
        <br><br>
        <button class="submitButton" onClick="copyText();">COPY LINK</button>
    </center>
    <br><br><br>

    <center>
        <form id="resumeUpload">
            <label for="resume">Select your resume file (PDF or DOCX):</label><br><br>
            <div id="resumeName">
                <input type="file" id="resume" name="resume"><br><br><br>
            </div>
            <button type="submit" class="submitButton">UPLOAD</button>
        </form>
        <br><br><br>
    </center>

    <div class="generalInfoInfo">
        My full name is: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="text" id="fullName" name="fullName" size="50"><br><br>
        My email address is: &nbsp;&nbsp;&nbsp;
        <input type="text" id="emailAddress" name="emailAddress" size="50"><br><br>
        My phone number is: &nbsp;&nbsp;&nbsp;
        <input type="text" id="phoneNumber" name="phoneNumber"><br><br>
        My minimum salary requirement is: &nbsp;&nbsp;&nbsp;
        <input type="text" id="salaryRequirement" name="salaryRequirement"><br><br><br><br>

        <div class="generalInfoSubtitleHeading">ONSITE vs REMOTE vs HYBRID</div><br><br>
        
        <input type="radio" id="onsiteInterestYes" name="onsiteInterest" value="onsiteInterestYes">
        <label for="onsiteInterestYes">I am interested in on-site work</label><br><br>
        <input type="radio" id="onsiteInterestNo" name="onsiteInterest" value="onsiteInterestNo">
        <label for="onsiteInterestNo">I am NOT interested in on-site work</label><br><br>
        <input type="radio" id="hybridInterestYes" name="hybridInterest">
        <label for="hybridInterestYes">I am interested in hybrid work</label><br><br>
        <input type="radio" id="hybridInterestNo" name="hybridInterest">
        <label for="hybridInterestNo">I am NOT interested in hybrid work</label><br><br>

        <input type="radio" id="remoteInterestYes" name="remoteInterest">
        <label for="remoteInterestYes">I am interested in remote work</label><br><br>
        <input type="radio" id="remoteInterestNo" name="remoteInterest">
        <label for="remoteInterestNo">I am NOT interested in remote work</label><br><br><br>

        <div class="generalInfoSubtitleHeading">FULLTIME/PARTTIME/CONTRACT</div><br><br>

        <input type="checkbox" id="fulltimeWork" name="fulltimeWork">
        <label for="fulltimeWork">I am interested in full-time work</label><br><br>
        <input type="checkbox" id="parttimeWork" name="parttimeWork">
        <label for="parttimeWork">I am interested in part-time work</label><br><br>
        <input type="checkbox" id="contractWork" name="contractWork">
        <label for="contractWork">I am interested in contract work</label><br><br><br>

        <div class="generalInfoSubtitleHeading">TRAVEL FOR WORK</div><br><br>

        <input type="radio" id="travelWorkYes" name="travelWork">
        <label for="travelWorkYes">I am willing to travel for work</label><br><br>
        <input type="radio" id="travelWorkNo" name="travelWork">
        <label for="travelWorkNo">I am NOT willing to travel for work</label><br><br><br>

        <div class="generalInfoSubtitleHeading">RELOCATION</div><br><br>

        <input type="radio" id="relocateYes" name="relocateWork">
        <label for="relocateYes">I am willing to relocate</label><br><br>
        <input type="radio" id="relocateNo" name="relocateWork">
        <label for="relocateNo">I am NOT willing to relocate</label><br><br><br>

        <div class="generalInfoSubtitleHeading">JOB SEARCH STATUS</div><br><br>

        <input type="radio" id="activeSearch" name="searchStatus">
        <label for="activeSearch">I am actively looking and interviewing for work</label><br><br>
        <input type="radio" id="idleSearch" name="searchStatus">
        <label for="idleSearch">I am interested in possibilities</label><br><br>
        <input type="radio" id="justLookingSearch" name="searchStatus">
        <label for="justLookingSearch">I am just seeing what is available</label><br><br><br>

        <div class="generalInfoSubtitleHeading">TIME TO START</div><br><br>

        <input type="radio" id="twoWeekNotice" name="startTime">
        <label for="twoWeekNotice">I need to give two weeks' notice to my employer</label><br><br>
        <input type="radio" id="noNotice" name="startTime">
        <label for="noNotice">I am available to start immediately</label><br><br><br>

        <div class="generalInfoSubtitleHeading">PROJECTS</div><br><br>
        <label for="currentProjects">Some of my current projects include:</label><br><br>
        <textarea id="currentProjects" name="currentProjects" rows="8" cols="75">List any projects you are currently working on. Be descriptive, as it will help the AI to describe those projects to visitors!</textarea><br><br>
        <label for="pastProjects">Some of my past projects include:</label><br><br>
        <textarea id="pastProjects" name="pastProjects" rows="8" cols="75">List any projects you worked on that you are proud of. Again, be descriptive, as it will help the AI to describe those projects to visitors!</textarea><br><br><br>

        <div class="generalInfoSubtitleHeading">SKILLS</div><br><br>
        Skills I would like to highlight: &nbsp;&nbsp;&nbsp;
        <input type="text" id="jobSkills" name="jobSkills" size="50"><br><br>
        <div class="generalInfoSubtitleHeading">ROLES</div><br><br>
        Some roles and/or titles I would consider: &nbsp;&nbsp;&nbsp;
        <input type="text" id="jobRoles" name="jobRoles" size="50"><br><br><br>
        <!-- <center><div class="submitButton" onclick="submitInfo();"><font style="font-size: 18px;">SUBMIT</font></div></center> -->

    </div>
    <center><div class="submitButton" onclick="submitInfo();"><font style="font-size: 18px;">SUBMIT</font></div></center>


    <ul class="homeMenu">
        <li class="homeMenuElement">
            <a href="javascript: account();" class="homeMenuElementButton">
                <div class="homeMenuElementIcon">
                    <span class="homeMenuElementIconHelper"></span>
                    <img src="static/images/home_admin.png">
                </div>
                <div class="homeMenuElementText">ACCOUNT</div>
            </a>
        </li>
        <li class="homeMenuElement">
            <a href="javascript: logout();" class="homeMenuElementButton">
                <div class="homeMenuElementIcon">
                    <span class="homeMenuElementIconHelper"></span>
                    <img src="static/images/logout.png">
                </div>
                <div class="homeMenuElementText">LOGOUT</div>
            </a>
        </li>
<!--         <li class="homeMenuElement">
            <a href="javascript: faq();" class="homeMenuElementButton">
                <div class="homeMenuElementIcon">
                    <span class="homeMenuElementIconHelper"></span>
                    <img src="static/images/faq.png">
                </div>
                <div class="homeMenuElementText">FAQ</div>
            </a>
        </li> -->
    </ul>
    <br><br><br><br>

</div>

<script>
//    initSystemDialog("divMainContainer");
    var url_string = window.location.href;
    var url = new URL(url_string);
    var userID = url.searchParams.get("id");
    getUserInfo(userID);

</script>
</body>
</html>
